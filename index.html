<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Centrul Personalizat de Preferințe - Actualizează-ți preferințele">
    <title>Centrul Personalizat de Preferințe</title>
    
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    
    <!-- Critical CSS inlined -->
    <style>
        /* Reset & Base Styles */
        *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
        body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:#fff;line-height:1.5;color:#333;-webkit-text-size-adjust:100%}
        
        /* Layout */
        .container{max-width:800px;margin:0 auto;background:#f9f9f9;border:1px solid #ddd;border-radius:15px;overflow:hidden}
        .header{background:#eee;padding:20px}
        .body-content{padding:20px}
        .row{display:flex;flex-wrap:wrap;gap:15px;margin-bottom:15px}
        .col{flex:1;min-width:280px}
        .col-half{flex:0 0 calc(50% - 7.5px)}
        
        /* Form Elements */
        input,select{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px;font-size:14px;outline:none;transition:border-color .2s}
        input:focus,select:focus{border-color:#b99300}
        label{display:block;margin-bottom:5px;font-weight:500;color:#555}
        
        /* Components */
        .divider{height:3px;background:#b99300;border-radius:2px;margin:10px 0}
        .btn{background:#b99300;color:#fff;border:none;padding:12px 30px;border-radius:4px;font-weight:bold;cursor:pointer;transition:background .2s}
        .btn:hover{background:#a68200}
        
        /* Header */
        .header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:15px}
        .logo{max-width:180px;height:auto;filter:brightness(0) invert(58%) sepia(75%) saturate(481%) hue-rotate(360deg) brightness(89%) contrast(84%)}
        
        /* Language Selector */
        .lang-selector{position:relative}
        .lang-selector select{background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6,9 12,15 18,9"/></svg>') no-repeat right 10px center;background-size:16px;padding-right:35px;appearance:none;min-width:120px}
        
        /* Checkbox Styles */
        .checkbox{display:flex;align-items:center;gap:8px;margin:10px 0}
        .checkbox input{width:auto;margin:0}
        
        /* Mobile Optimizations */
        @media (max-width:768px){
            .container{margin:10px;border-radius:10px}
            .header,.body-content{padding:15px}
            .col-half{flex:1}
            .row{gap:10px}
            .logo{max-width:150px}
            h4{font-size:16px}
        }
        
        /* Utility Classes */
        .hidden{display:none}
        .text-center{text-align:center}
        .text-gold{color:#b99300}
        .mb-0{margin-bottom:0}
        .mt-20{margin-top:20px}
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <img src="https://www.northbucharestinvestments.ro/dist/app/media/img/other/logo-white.svg" alt="Logo" class="logo">
            <div>
                <h4 class="text-gold" id="updatePreferences">Actualizează-ți preferințele</h4>
                <div class="lang-selector">
                    <select id="languageSelector" onchange="setLanguage(this.value)">
                        <option value="ro">Română</option>
                        <option value="en">English</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Form Content -->
        <div class="body-content">
            <form id="preferenceForm">
                <!-- Hidden Fields -->
                <input type="hidden" name="subKey" value="00QTY00000Is69J2AR">
                <input type="hidden" name="inquiryId" value="a1ATY00000N39ZN2AZ">
                <input type="hidden" name="emailName" value="schedule-call-emailer-en">
                <input type="hidden" name="journeyName" value="Welcome-journey">
                <input type="hidden" id="countryCodePhone" name="countryCodePhone" value="40">

                <!-- Personal Information -->
                <div class="row">
                    <h4 id="personalInfo">INFORMAȚII PERSONALE</h4>
                    <div class="divider"></div>
                </div>

                <div class="row">
                    <div class="col-half">
                        <label id="labelFirstName">Prenume</label>
                        <input type="text" name="firstName" value="Mr Gheorghe">
                    </div>
                    <div class="col-half">
                        <label id="labelLastName">Nume</label>
                        <input type="text" name="lastName" value="Condrea">
                    </div>
                </div>

                <div class="row">
                    <div class="col-half">
                        <label id="labelEmail">Email</label>
                        <input type="email" name="email" value="gscondrea@gmail.com" required>
                        <span class="error-msg hidden" id="error-message-email">Te rugăm să introduci adresa de email.</span>
                    </div>
                    <div class="col-half">
                        <label id="labelMobile">Mobil</label>
                        <div style="display:flex;gap:5px">
                            <select name="mobileCountryCode" id="mobileCountryCode" style="flex:0 0 80px">
                                <option value="+40" selected>+40</option>
                                <option value="+1">+1</option>
                                <option value="+33">+33</option>
                                <option value="+49">+49</option>
                                <option value="+39">+39</option>
                                <option value="+34">+34</option>
                                <option value="+44">+44</option>
                                <option value="+373">+373</option>
                                <option value="+41">+41</option>
                                <option value="+43">+43</option>
                                <option value="+31">+31</option>
                                <option value="+32">+32</option>
                                <option value="+46">+46</option>
                                <option value="+45">+45</option>
                                <option value="+47">+47</option>
                                <option value="+48">+48</option>
                                <option value="+420">+420</option>
                                <option value="+421">+421</option>
                                <option value="+36">+36</option>
                                <option value="+385">+385</option>
                                <option value="+386">+386</option>
                                <option value="+359">+359</option>
                                <option value="+30">+30</option>
                                <option value="+90">+90</option>
                            </select>
                            <input type="tel" name="mobileNumber" value="60807766" style="flex:1">
                        </div>
                        <span class="error-msg hidden" id="error-message-mobile">Te rugăm să introduci numărul de telefon.</span>
                    </div>
                </div>

                <!-- Interest Domains -->
                <div class="row mt-20">
                    <h4 id="interestDomains">DOMENII DE INTERES</h4>
                    <div class="divider"></div>
                </div>

                <div class="row">
                    <div class="col-half">
                        <div class="checkbox">
                            <input type="checkbox" id="newsletter" name="newsletter" checked>
                            <label for="newsletter" id="newsletterLabel">Newsletter</label>
                        </div>
                        <div class="checkbox">
                            <input type="checkbox" id="learning" name="learning" checked>
                            <label for="learning" id="educationLabel">Lansări de proiecte noi & Evenimente</label>
                        </div>
                    </div>
                    <div class="col-half">
                        <div class="checkbox">
                            <input type="checkbox" id="offers" name="offers" checked>
                            <label for="offers" id="offersLabel">Oferte & Promoții</label>
                        </div>
                    </div>
                </div>

                <!-- Request Call -->
                <div class="row mt-20">
                    <h4 id="requestCall">SOLICITĂ UN APEL</h4>
                    <div class="divider"></div>
                </div>

                <div class="row">
                    <div class="col-half">
                        <label id="dateLabel">Data</label>
                        <input type="date" name="date" id="date" required>
                        <span class="error-msg hidden" id="error-message-Date">Nu poți selecta date din trecut.</span>
                    </div>
                    <div class="col-half">
                        <label id="timezoneLabel">Fus orar</label>
                        <select name="timeZone" id="timezoneSelect">
                            <option id="timezoneOption">GMT+2 (România)</option>
                        </select>
                        <small class="text-gold" id="dubaiTimezoneLabel">Fus orar România*</small>
                    </div>
                </div>

                <div class="row">
                    <div class="col-half">
                        <label id="timeLabel">Ora</label>
                        <select name="time">
                            <option>09:00–10:00</option>
                            <option>10:00–11:00</option>
                            <option>11:00–12:00</option>
                            <option>12:00–13:00</option>
                            <option>13:00–14:00</option>
                            <option>14:00–15:00</option>
                            <option>15:00–16:00</option>
                            <option>16:00–17:00</option>
                            <option>17:00–18:00</option>
                            <option>18:00–19:00</option>
                        </select>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="row mt-20">
                    <button type="button" class="btn" onclick="handleSubmit()" id="submitButton">Trimite</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Load non-critical resources asynchronously -->
    <script>
        // Load external resources after page load
        window.addEventListener('load', function() {
            // Load SweetAlert2
            const sweetAlert = document.createElement('link');
            sweetAlert.rel = 'stylesheet';
            sweetAlert.href = 'https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css';
            document.head.appendChild(sweetAlert);

            const sweetAlertJS = document.createElement('script');
            sweetAlertJS.src = 'https://cdn.jsdelivr.net/npm/sweetalert2@11';
            document.head.appendChild(sweetAlertJS);

            // Load Google Fonts
            const googleFonts = document.createElement('link');
            googleFonts.href = 'https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap';
            googleFonts.rel = 'stylesheet';
            document.head.appendChild(googleFonts);
        });

        // Initialize form
        document.addEventListener('DOMContentLoaded', function() {
            // Set default country code to +40
            document.getElementById('mobileCountryCode').value = '+40';
            
            // Set minimum date to tomorrow
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            const formattedDate = tomorrow.toISOString().split('T')[0];
            document.getElementById("date").value = formattedDate;
            document.getElementById("date").setAttribute("min", formattedDate);
        });

        // Translations
        const translations = {
            ro: {
                updatePreferences: "Actualizează-ți preferințele",
                personalInfo: "INFORMAȚII PERSONALE",
                labelFirstName: "Prenume",
                labelLastName: "Nume",
                labelEmail: "Email",
                labelMobile: "Mobil",
                interestDomains: "DOMENII DE INTERES",
                newsletterLabel: "Newsletter",
                offersLabel: "Oferte & Promoții",
                educationLabel: "Lansări de proiecte noi & Evenimente",
                requestCall: "SOLICITĂ UN APEL",
                dateLabel: "Data",
                timezoneLabel: "Fus orar",
                timezoneOption: "GMT+2 (România)",
                dubaiTimezoneLabel: "Fus orar România*",
                timeLabel: "Ora",
                submitButtonText: "Trimite",
                sendingMessage: 'Se trimite formularul...',
                successTitle: 'Felicitări!',
                successMessage: 'Formularul a fost trimis cu succes. În scurt timp veți fi contactat de către echipa noastră.',
                errorTitle: 'Eroare!',
                errorMessage: 'A apărut o eroare. Vă rugăm să încercați din nou.',
                okButton: 'OK'
            },
            en: {
                updatePreferences: "Update your preferences",
                personalInfo: "PERSONAL INFORMATION",
                labelFirstName: "First Name",
                labelLastName: "Last Name",
                labelEmail: "Email",
                labelMobile: "Mobile",
                interestDomains: "INTEREST DOMAINS",
                newsletterLabel: "Newsletter",
                offersLabel: "Offers & Promotions",
                educationLabel: "New Project Launches & Events",
                requestCall: "REQUEST A CALL",
                dateLabel: "Date",
                timezoneLabel: "Timezone",
                timezoneOption: "GMT+2 (Romania)",
                dubaiTimezoneLabel: "Romania timezone*",
                timeLabel: "Time",
                submitButtonText: "Submit",
                sendingMessage: 'Sending form...',
                successTitle: 'Congratulations!',
                successMessage: 'The form has been successfully submitted. Our team will contact you shortly.',
                errorTitle: 'Error!',
                errorMessage: 'An error occurred. Please try again.',
                okButton: 'OK'
            }
        };

        function setLanguage(lang) {
            for (const key in translations[lang]) {
                const el = document.getElementById(key);
                if (el) {
                    if (el.tagName === 'INPUT' && el.type === 'button') {
                        el.value = translations[lang][key];
                    } else {
                        el.textContent = translations[lang][key];
                    }
                }
            }
        }

        // Submit function
        async function handleSubmit() {
            const formData = {
                firstName: document.querySelector('input[name="firstName"]')?.value || '',
                lastName: document.querySelector('input[name="lastName"]')?.value || '',
                email: document.querySelector('input[name="email"]')?.value || '',
                mobilePhone: (document.getElementById('mobileCountryCode')?.value || '') + 
                            (document.querySelector('input[name="mobileNumber"]')?.value || ''),
                callbackDate: document.querySelector('input[name="date"]')?.value || '',
                time: document.querySelector('select[name="time"]')?.value || '',
                newsletter: document.getElementById('newsletter')?.checked || false,
                offers: document.getElementById('offers')?.checked || false,
                learning: document.getElementById('learning')?.checked || false
            };

            try {
                // Check if SweetAlert2 is loaded
                if (typeof Swal !== 'undefined') {
                    Swal.fire({
                        title: 'Se trimite...',
                        allowOutsideClick: false,
                        showConfirmButton: false,
                        didOpen: () => Swal.showLoading()
                    });
                }

                const response = await fetch('https://script.google.com/macros/s/AKfycbwdN7lN081xW6mcbjGJ3yTH7CrT1Siw-9C_ZLgWccFl63OCzmKIYwQ_u6wRxgb4-_pYcw/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                // Success
                if (typeof Swal !== 'undefined') {
                    const currentLang = document.getElementById('languageSelector').value;
                    Swal.fire({
                        title: translations[currentLang].successTitle,
                        text: translations[currentLang].successMessage,
                        icon: 'success',
                        confirmButtonText: translations[currentLang].okButton
                    });
                } else {
                    alert('Formularul a fost trimis cu succes!');
                }

                document.getElementById("preferenceForm").style.display = "none";

            } catch (error) {
                console.error('Error:', error);
                if (typeof Swal !== 'undefined') {
                    const currentLang = document.getElementById('languageSelector').value;
                    Swal.fire({
                        title: translations[currentLang].errorTitle,
                        text: translations[currentLang].errorMessage,
                        icon: 'error',
                        confirmButtonText: translations[currentLang].okButton
                    });
                } else {
                    alert('A apărut o eroare. Vă rugăm să încercați din nou.');
                }
            }
        }

        // Set default language to Romanian
        setLanguage('ro');
    </script>

    <!-- Add error styles -->
    <style>
        .error-msg {
            color: #e74c3c;
            font-size: 12px;
            margin-top: 5px;
        }
        .error-msg.hidden {
            display: none;
        }
    </style>
</body>
</html>